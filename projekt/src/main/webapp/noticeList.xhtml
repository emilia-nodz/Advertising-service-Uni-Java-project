<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      lang="pl">
<h:head>
    <title>Lista ogłoszeń</title>
    <h:outputStylesheet library="css" name="bootstrap.min.css"/>
</h:head>
<h:body>
    <ui:include src="/WEB-INF/include/navbar.xhtml" />
    <h:messages/>
    <div class="container mt-4">
        <h:form style="width:150px;" id="searchForm">
            <label for="category" class="form-label">Kategoria:</label>
            <h:selectOneMenu id="category" class="form-select"
                             value="#{noticeController.searchCategory}"
                             styleClass="form-select"
                             converter="categoryConverter">
                <f:selectItem itemLabel="-- Wszystkie kategorie --" itemValue="#{null}"/>
                <f:selectItems value="#{categoryController.categories}" var="cat"
                               itemLabel="#{cat.name}" itemValue="#{cat}"/>
                <f:ajax event="change" listener="#{noticeController.search}"
                        render=":noticeList" execute="@this"/>
            </h:selectOneMenu>
        </h:form>

        <br></br>

        <h1>Lista ogłoszeń</h1>
        <br></br>
        <h:panelGroup id="noticeList">
        <ui:repeat value="#{noticeController.moderatedNotices}" var="notice">
            <div class="card mb-3">
                <div class="card-body">
                    <h5 class="card-title">#{notice.title}</h5>
                    <p class="card-text">#{notice.description}</p>
                    <p class="card-text"><strong>Kategoria:</strong> #{notice.category.name}</p>
                    <p class="card-text"><strong>Kwota:</strong> #{notice.amount}</p>
                    <ui:fragment rendered="#{notice.updateDate != null}">
                        <p class="card-text">
                            <strong>Data aktualizacji:</strong> #{notice.updateDate}
                        </p>
                    </ui:fragment>
                </div>
            </div>
        </ui:repeat>
        </h:panelGroup>
    </div>
</h:body>
</html>
